
import boto3
import json
def lambda_handler(event, context):
    print("Event:", json.dumps(event))
    try:
        body = json.loads(event['body'])
        recipient = body.get("to")
        subject = body.get("subject")
        message = body.get("message")
    except Exception as e:
        return {
            'statusCode': 400,
            'body': json.dumps({'error': 'Invalid request: ' + str(e)})
        }
    sender = "saikumarg738@gmail.com"  # Must be verified in SES
    region = "us-east-1"
    client = boto3.client("ses", region_name=region)
    try:
        response = client.send_email(
            Source=sender,
            Destination={'ToAddresses': [recipient]},
            Message={
                'Subject': {'Data': subject},
                'Body': {'Text': {'Data': message}}
            }
        )
        return {
            'statusCode': 200,
            'body': json.dumps({
                'message': 'Email sent successfully',
                'MessageId': response['MessageId']
            })
        }
    except Exception as e:
        return {
            'statusCode': 500,
            'body': json.dumps({'error': str(e)})
        }







Bash Script : 


#!/bin/bash

API_URL="https://c685ek9dfa.execute-api.us-east-1.amazonaws.com/SendEmail-SES"

curl -X POST "$API_URL" \
  -H "Content-Type: application/json" \
  -d '{
    "to": "saikumarg738@gmail.com",
    "subject": "Hello from Bash",
    "message": "This email was triggered using curl and API Gateway."
  }'





Email with Attachment


import boto3
import base64
import json
import os
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
from email.mime.application import MIMEApplication
def lambda_handler(event, context):
    try:
        body = json.loads(event.get("body", "{}"))
        recipient = body["to"]
        subject = body["subject"]
        message = body["message"]
        attachment_name = body["attachment_name"]
        attachment_content = body["attachment_content"]  # base64-encoded
    except Exception as e:
        return {
            'statusCode': 400,
            'body': json.dumps({'error': f'Invalid input: {str(e)}'})
        }
    sender = "saikumarg738@gmail.com"  # Verified in SES
    region = "us-east-1"
    # Create the MIME message
    msg = MIMEMultipart()
    msg["Subject"] = subject
    msg["From"] = sender
    msg["To"] = recipient
    # Add body
    body_part = MIMEText(message, "plain")
    msg.attach(body_part)
    # Add attachment
    try:
        attachment_data = base64.b64decode(attachment_content)
        part = MIMEApplication(attachment_data)
        part.add_header(
            "Content-Disposition",
            f'attachment; filename="{attachment_name}"'
        )
        msg.attach(part)
    except Exception as e:
        return {
            'statusCode': 400,
            'body': json.dumps({'error': f'Invalid attachment data: {str(e)}'})
        }
    # Send the email via SES
    ses = boto3.client("ses", region_name=region)
    try:
        response = ses.send_raw_email(
            Source=sender,
            Destinations=[recipient],
            RawMessage={"Data": msg.as_string()}
        )
        return {
            'statusCode': 200,
            'body': json.dumps({'message': 'Email sent', 'MessageId': response["MessageId"]})
        }
    except Exception as e:
        return {
            'statusCode': 500,
            'body': json.dumps({'error': str(e)})
        }



Bash : 


#!/bin/bash

API_URL="https://mssniubo8k.execute-api.us-east-1.amazonaws.com/SendEmailAttachement"

TO="sai.gangupamu@broadridge.com"
SUBJECT="Test Email with Attachment"
MESSAGE="Hello, this is an email with an attachment sent from AWS SES!"
FILE_PATH="/home/ec2-user/decoded_output"
ATTACHMENT_NAME="sample.txt"

# Base64 encode the file
ATTACHMENT_BASE64=$(base64 "$FILE_PATH")

# Construct the JSON payload
read -r -d '' PAYLOAD <<EOF
{
  "to": "$TO",
  "subject": "$SUBJECT",
  "message": "$MESSAGE",
  "attachment_name": "$ATTACHMENT_NAME",
  "attachment_content": "$ATTACHMENT_BASE64"
}
EOF

# Send the request
curl -X POST "$API_URL" \
  -H "Content-Type: application/json" \
  -d "$PAYLOAD"


